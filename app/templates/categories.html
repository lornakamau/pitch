{% extends 'base.html'%}
{% block styles %}
{{ super() }}
<link rel="stylesheet" href="{{url_for('static',filename='css/categories.css')}}" type="text/css">
{% endblock %}
{% block content %}
<div class="row">
  <!--Flash message -->
  {% for message in get_flashed_messages() %}
  <div class="alert alert-success">
    <button type="button" class="close" data-dismiss="alert">&times;</button>
    {{ message }}
  </div>
  {% endfor %}
  <div class="col-md-6">
    <h2 class="text-center">{{category_name}} Pitches</h2>
    {% if pitches %}
    <div class="jumbotron">
      {% for pitch in pitches %}
        <div class="card">
          <div class="card-body">
            <!-- <img class="rounded-circle" src="{{url_for('static', filename='photos/'+ pitch.pitcher.profile_pic_path)}}"> -->
            <blockquote class="blockquote mb-0">
              <p>{{pitch.pitch_content}}</p>
              <footer class="blockquote-footer"><cite title="Source Title">{{pitch.pitcher.username}}</cite></footer>
              <small style="float: right;" style="cursor: pointer !important"><a href="/comment/{{pitch.id}}">Comment</a></small>
            </blockquote>
          </div>
          <div class="card-footer text-muted" id="details">
            <small>Submitted on {{pitch.posted.strftime('%Y-%m-%d')}}</small><br>
            <button class="btn"><a href="{{url_for('main.upvote', uname = current_user.id ,pitch_id = pitch.id)}}">{{pitch.upvotes}}<i class="fas fa-thumbs-up"></i>&nbsp;like</a></button>&nbsp;&nbsp;
            <button class="btn"><a href="{{url_for('main.downvote', uname = current_user.id ,pitch_id = pitch.id)}}">{{pitch.downvotes}}<i class="fas fa-thumbs-up"></i>&nbsp;dislike</a></button>&nbsp;&nbsp;
          </div>
        </div>
        
          {% for comment in comments %}
            {%if comment.pitch_id == pitch.id %}
            <div class="card">
              <div class="card-body">
                <div class="language">{{comment.author.username}}</div>
                <p class="card-text">{{comment.comment_content}}</p>
                <br>
              </div>
            </div>
            {%else%}
              <h4>This pitch has no comments</h4>
              <a href="/comment/{{pitch.id}}">Comment</a>
            {% endif %}
          {% endfor%}
          {% endfor%}
    </div>
    {%else%}
    <p id="nothing">There are no pitches in this category</p>
    <a href="{{url_for('main.new_pitch', uname=current_user.username)}}">New Pitch</a>
    {%endif%}
  </div>
  <div class="col-md-6">

  </div>
</div>
{% endblock %}